# קורס ריאקט חלק יא' - סביבות ותהליכי עבודה

## פתיחה

עד עכשיו פיתחנו אפליקצייה של ריאקט, על הרבה מהחלקים שלה. בנינו UI, ניהול סטייט וגם כתבנו טסטים לראות שהקוד עובד.

בחלק הזה, נתעסק מעט בקוד עצמו, ויותר במה "שמקיף" את הקוד, הסביבה שבה הקוד חי. בנוסף נתעסק בתהליכים שיכולים לקרות בסביבות האלו, ובאוטומציה שלהם.

## חזרה על הכלים שאנחנו עובדים איתם

נעבור על המצגת ונכיר מושגים שונים. חלק מהמושגים, יהיו קצת סינית, אבל נעבור על כולם.

## דב-אופס ותפיסות שונות

שימו לב שבתוך התהליכים והסיבות, יש כל מני כלים, שצריכים לעבוד ביחד. בשנים האחרונות התפתח תחום שנקרא **DevOps** שאומר, שיש אנשים שמתמחים רק בכל הכלים והתהליכים של הפיתוח. ואני המפתח, לא צריך לדעת כלום, רק צריך לכתוב את הקוד, וזהו.

יש בזה הגיון מסויים, אבל אני וגם בדרור סופט יוצאים מנקודת הנחה שמפתחים ומפתחות צריכים להכיר את כל הנושאים האלו.

זה מאותה סיבה שאם אתה מבשל אוכל כדאי שתכירו איך עובד המיקסר ואת כל הפונקציות של התנור.

כי הכלים שמאפשרים את הפיתוח משפיעים גם על אופי הפיתוח וכו'

## שרת הפיתוח ופקודת הבילד

בעצם כמו שאמרנו בפעם הראשונה שדיברנו על ריאקט, הדפדפן לא יודע מה זה JSX. אז בואו רגע נראה מהם הקבצים שהדפדפן מקבל. נפתח כלי מפתחים, ותחת הרשת, נראה אילו קבצים קיבלנו:

אם ניקח את הקובץ ICE CREAM VISUAL שהוא בסך הכל מרכיב גרפי יחסית פשוט, אנחנו רואים שהדפדפן רואה אותו כמשהו שונה. זאת אומר, VITE עשה לו כל מני דברים לפני שהוא שולח אותו לדפדפן.

בעצם גם בזמן הפיתוח וגם כשהאתר מוגש, הקבצים שלו עוברים קומפילציה או טרנספילציה, שזה המרה משפה א' לשפה ב'.

התהליך הזה נקרא **בילד**, דהיינו בנייה של הפרוייקט מחדש.

בואו נריץ את פקודת הבילד ונראה מה קורה:

```bash
npm run build
```

### הערה:
לפני שעושים את זה צריך לודא שהאופציה בתוך vite

```javascript
base : ""
```

כדי שיבנה URL יחסי

### מה עושה הבילד
אז בעצם כמו שאנחנו רואים כאן, הוא לקח את כל האפליקצייה שלנו, ובנה ממנה, 5 קבצים. רוב הקבצים קטנים. אבל קובץ ה-JS הוא ממש גדול, חצי מגה. למה חצי מגה? הרי לא כתבנו כל כך הרבה קוד?

בעצם מה שקורה בתוך קובץ ה-JS, זה לא רק הקוד שאנחנו כתבנו. זה גם הקוד של הספריות שאנחנו משתמשים בהם:
- react
- react-router
- firebase

בואו נראה את הקובץ JS:

לא קריא בעליל.

אז בבילד אפשר לעשות כל מני דברים, אבל בעיקר מנסים לאפטם ולהקטין את גודל הקבצים. אפשר גם לעשות עוד תהליכים כמו להעיף הערות וכו'.

## סורס מפס

אז אם הדפדפן לא יודע מה זה קומפוננטות ריאקט, איך אנחנו יכולים לדבג בפיתוח?

אם נסתכל שוב על הקבצים שאנחנו מקבלים בדפדפן, נראה שיש בהם איזו שורה מוזרה בהערה למטה.

יש משהו שנקרא **source maps**.

שזה קבצים שמחברים בין קבצי המקור שלנו (בהם אנחנו כותבים קוד) לתוצאה הסופית. יש את זה בכל השפות המתקמפלות בגרסאות שונות.

## הגשת הפרוייקט מהבילד
להגיש את הפרוייקט מהבילד נריץ את הפקודה:

```bash
npm vite preview
```

מה שהפקודה עושה לנו היא בעצם בונה מעין שרת שמגיש את הקבצים מה-BUILD.

למה צריך שרת שיגיש את הקבצים?

כשבנינו בקורס פרונט הפתיחה הראשון במקומי קובץ HTML יכולנו להוסיף לו קבצי JS אם הם היו בתיקייה לידו. פה אנחנו לא יכולים, למה?

## CI/CD עם GitHub Actions

```yaml
name: Ice cream app CI

on:
  push:

jobs:
  build:
    # ההגדרות חסרות כאן
```

נסביר בעצם מה הצעדים שקורים כאן.

הנקודה החשובה שצריך להבין שכל זה רץ בקונטיינר, שזה כמו מיני מערכת הפעלה (לינוקס) שקמה ובתוכה אפשר לעשות כל מני פעולות. כולל יציאה לרשת.

עכשיו בואו נראה מה קורה בצד של גיטאב:

נכנס לריפו, לגיטאהב ונראה מה קורה באקשן. כל הקוד שכתבתי רץ.

זה מריץ את הטסטים ורואה אם הכל בסדר.

עכשיו בואו ונעשה נסיון להכשיל את הטסטים.

נגיד שבאתי ועשיתי טעות בטעות שינית משהו, למשל את הרג'קס של הטלפון ל-9 ספרות. נראה מה קורה:

אז שימו לב, גם הבילד נכשל, וגם קיבלתי על זה מייל: הבילד נכשל, אם אני נכנס לבילד אני יכול לראות ממש מהי סיבת הכישלון.

## פריסת האתר

אז ככה, בדרך כלל כשאנחנו רוצים לפרוס את האתר לפרודקשיין, נדחוף אותו לענף שנקרא פרודקשן.

נדחוף אותו ל-[GitHub Pages](https://pages.github.com/). בשביל זה צריך לאפשר את הדחיפה הזו (זה פיצ'ר חדש).

ללכת ל-SETTING של הריפו:

1. ואז ל-Environments
2. ואז ל-github-pages
3. בתוך "1 branch and 0 tags allowed" לשנות את ענף ברירת המחדל מ-MAIN ל-PRODUCTION

```yaml
name: Deploy static content to Pages

on:
  push:
    branches: ["production"]

  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node-version: [ 22.x ]
    steps:
      - uses: actions/checkout@v4
      - name: Use Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v3
        with:
          node-version: ${{ matrix.node-version }}
          cache: 'npm'
          cache-dependency-path: './'
      # המשך ההגדרות חסר כאן
```

עכשיו יש לי עוד שגיאה מכיוון שאין לי את הקובץ הפרטי, אז מה שאני אעשה אני אוסיף אותו בצורה של האק.

וזהו זה עובד באתר הזה!

## סיכום

בפרק הזה התעסקנו בתהליכי פיתוח שונים, הכרנו את סביבות העבודה השונות ואיך לעבוד איתן. למרות שלא מדובר כאן בקוד שקשור רק לממשק משתמש וכו', או שמוצג ישירות בקומפוננטות, זה חשוב להכיר את הסביבות ואת תהליכי העבודה איתם, לחווית פיתוח יותר משמעותית.

[חזרה לראש העמוד](#קורס-ריאקט-חלק-יא---סביבות-ותהליכי-עבודה)